# VPS自建代理快速实战：稳定使用Claude与开发工具的操作指南

## 前言：直奔主题

本文是一份纯粹的 **操作手册**，旨在让你以最快的速度，从零开始搭建并配置好个人专属的代理服务。我们的目标只有一个：稳定、流畅地使用Claude等AI工具。

如果你对背后的“为什么”感兴趣，可以阅读文章末尾的 **【原理解析】** 部分。现在，让我们开始动手。

---

## 第一部分：实战操作手册 (The How-To Guide)

### Step 1: 选择并安装本地客户端

*   **要做什么：** 下载并安装 `Clash` 客户端。
*   **为什么选它：** 跨平台（Mac/Win），规则配置最方便。
*   **动作：** （此处可以放上Clash for Windows 和 ClashX for Mac的官方或Github下载页面链接）。

### Step 2: 购买并准备VPS服务器

*   **要做什么：** 购买一台低延迟的境外VPS。
*   **推荐：** Lisahost 的“美国顶级精品网9929线路VPS”。
*   **关键点：** 选择“低延迟”线路，这对AI Code等实时应用至关重要。

### Step 3: 在VPS上部署代理服务

*   **要做什么：** 使用 Docker 快速部署 Shadowsocks 服务。
*   **技术栈：** `Shadowsocks-Go` + `Docker`。
*   **操作流程：**
    1.  SSH连接到你的VPS。
    2.  安装Docker。（可以引导读者直接问AI：“如何在CentOS/Ubuntu上安装Docker？”）
    3.  执行以下命令一键启动服务（可将命令中的密码等关键信息高亮）：
        ```bash
        # 示例命令，引导读者替换密码和端口
        docker run -d --name shadow-go -p 8000:8000 -p 8001:8001/udp -e PASSWORD="YOUR_PASSWORD" -e METHOD="aes-256-gcm" shadowsocks/shadowsocks-go
        ```
    4.  在本地Clash客户端中，根据你的VPS IP、端口、密码添加这个服务器节点。

### Step 4: 验证IP质量与连通性

*   **要做什么：** 确保你的新IP是“干净”且可用的。
*   **验证三部曲：**
    1.  **测速：** 在Clash客户端内，对新节点进行延迟测试（Benchmark），确保能连通。
    2.  **查风险：** 将Clash设为 **全局模式(Global Mode)**，打开浏览器访问 `ping0.cc`。检查IP风险分，目标是 **低于30**，越低越好。
    3.  **测访问：** 打开浏览器的 **无痕窗口**，访问 `claude.ai`，看是否能正常打开。
*   **注意：** 如果风险分过高，立即去VPS服务商网站更换IP，然后重复此步骤。

### Step 5: 配置开发工具代理

*   **要做什么：** 让你的代码编辑器和命令行工具也走代理。
*   **1. 命令行/终端 (Terminal):**
    *   在 `~/.zshrc` (或 `~/.bash_profile`) 文件末尾添加：
        ```bash
        export HTTPS_PROXY=http://127.0.0.1:7890
        export HTTP_PROXY=http://127.0.0.1:7890
        export ALL_PROXY=socks5://127.0.0.1:7890 # 有些工具需要
        ```
    *   *注：`7890` 是Clash的默认HTTP端口，请根据你的客户端调整。*
*   **2. VS Code / Cursor:**
    *   按 `Ctrl/⌘ + Shift + P`，搜索并打开 `settings.json`。
    *   添加以下配置：
        ```json
        "http.proxy": "http://127.0.0.1:7890",
        "http.proxySupport": "override"
        ```

**至此，所有操作已完成。享受你的专属网络通道吧！**

---

## 第二部分：原理解析 (The "Why")

如果你已经顺利完成了上面的配置，并好奇我们每一步背后的原因，这部分将为你解答。

### 1. 问题的本质：为什么公共VPN不稳定且易被封？

*   **IP的“纯净度”：** 住宅IP vs. 数据中心IP。AI服务商更信任前者。
*   **IP的“拥挤度”：** 公共VPN一个IP成百上千人用，极易因滥用被集体拉黑。自建VPS则保证了IP的独享性。
*   **IP的“稳定性”：** 频繁切换IP地址是账号风控的大忌。通过客户端的“规则”配置，可以保证访问特定网站时，永远走我们固定的VPS IP。

### 2. 客户端的核心作用：不止是开关，更是“交通调度员”

*   解释什么是“规则(Rule)”，它是如何实现国内外网站智能分流的。
*   强调这是保证“IP稳定性”的技术基础。

### 3. VPS的门道：线路、带宽和IP类型

*   简单科普VPS线路（如9929, 4837）对延迟和速度的影响。
*   再次强调“原生IP/住宅IP”在绕过地理限制和风控中的重要性。

### 4. 开发工具的“最后一公里”

*   解释为什么浏览器能自动代理，而VS Code和命令行却不行。
*   点明“系统代理”和“应用层代理”的区别，让读者理解为每个工具单独配置的必要性。
