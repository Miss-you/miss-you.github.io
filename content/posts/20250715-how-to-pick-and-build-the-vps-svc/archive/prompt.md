写作目标：

有翻墙需要且使用claude 的用户，能够教他们一个完整的流程，从本地代理到vps搭建，再到轻松使用claude的事情

我觉得可以整体分这么几块：

## 第一部分，选择什么样的客户端代理

最开始自己的开发环境，应该怎么配置vpn或者代理

客户端科学上网工具很多，比如clash、等等；不同的客户端配置不同，重要的是rule规则配置便于维护

可以都下载几个，选一个自己觉得rule规则好理解好维护的工具「个人认为shadowsocks的客户端很难用

我使用的是clash，mac有clash版，win也有Clash for windows

## 第二部分，服务端代理 

服务器选什么？其实试错成本很少，所以完全是找的使用了2年的朋友推荐。我这里选用了lisahost的
{年付特价VPS --没有为什么，因为便宜。}

这两个也可以，区别在于一个带宽大一个时延低，我选择的是时延低的，即便是这样200-400ms还是有的，但使用claude code是完全足够的
美国顶级精品网9929线路VPS一期【双isp家宽住宅美国原生IP 】HOT 全新双isp住宅IP段
美国4837线路超大带宽VPS【双isp家宽住宅美国原生IP, 不限流量VPS】 HOT 全新双isp住宅IP段

> 注意，这个ip是无法使用Google Gemini的「非常诡异」
>

我觉得还有一个很重要的点在于。就是怎么去降低或者避免被claude封号的情况

总结了社区的常见封号场景，以及自己的经历，当然个人认为比较重要的是两点
1. ip是否干净，或者说ip的风险如何。其主要风险点在于，是不是原生ip、家庭ip；这个ip的外网公用数量「比如购买公共vpn服务，大概率一个ip会被上千个人使用，其大概率是风险的，被封也不奇怪 了』
2. 另一个是ip是否经常切换，所以这里就需要依赖于本地翻墙工具的rule规则，让自己不论何时何地使用的时候，访问claude都是走自建vps服务

ok，继续

接下来要关心的是，vps怎么搭建，其实很简单，因为已经有很多版本了

从便于部署维护的角度，我的选择是选用go版本的shadowrocks服务『github有』+docker化部署

最终类似启动命令是这样，其实知道用什么之后，指挥claude或者gpt一步一步详细教自己如何部署就可以了


部署好之后，本地配置一下代理服务，然后做两个事情：
1. 本地翻墙服务有Benchmark的功能，其可以验证其vps服务的延迟以及是否连通，用一下
2. 改为全局模式或者改一下rule规则，访问ping0.cc，去查看自己的ip其风险度如何，需要风险度在30以内，最好是10以内；如果一旦超了抓紧联系客服或者看看页面有没有更换外网ip的功能，换一个新的ip重复这个流程
3. 在无痕模式下，访问claude.ai，验证能否访问通

## 第三部分

工具的代理配置

主要的一点就是，使用了翻墙工具后，浏览器是会默认走代理的，但比如cursor、vscode或者claudecode等，并不会默认走代理

所以要做的事情是两个：

针对于claude code和gemini cli，需要在cli配置，指定其访问翻墙服务代理
```
HTTPS_PROXY=http://127.0.0.1:7890
HTTP_PROXY=http://127.0.0.1:7890
```

具体如何固化，避免每次都配置，可以咨询ai

接下来，cursor和vs code的配置则参考

1. 在 Cursor 中按 `Ctrl/⌘ + Shift + P` 打开命令面板
2. 输入`settings json`并选择：`Preferences: Open User Settings (JSON)`

**步骤2：添加代理配置**
在JSON配置中添加以下三行关键配置：

```json
{
  // ... 你的其他设置
  "http.proxy": "http://127.0.0.1:7890",
  "http.proxySupport": "override",
  "cursor.general.disableHttp2": true
}
```

**步骤3：根据代理工具调整端口**
不同代理工具的默认HTTP代理端口：
- **Clash for Windows**: `7890`
- **V2RayN**: `10809`
- **Surge**: `6152`
- **Shadowrocket**: `1087`
